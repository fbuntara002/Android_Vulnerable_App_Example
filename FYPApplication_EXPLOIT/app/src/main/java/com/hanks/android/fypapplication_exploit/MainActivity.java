package com.hanks.android.fypapplication_exploit;

import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class MainActivity extends AppCompatActivity {

    EditText packageName;
    EditText applicationName;
    EditText logFilter;
    Button exploitButton;
    Button exploitButton2;
    TextView result;

    final String PACKAGE_NAME = "package_name";
    final String APP_NAME = "application_name";
    final String LOG_FILTER = "log_filter";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        exploitButton = (Button) findViewById(R.id.exploitButton);
        exploitButton2 = (Button) findViewById(R.id.exploitButton2);
        packageName = (EditText) findViewById(R.id.package_name);
        applicationName = (EditText) findViewById(R.id.application_name);
        logFilter = (EditText) findViewById(R.id.log_text);

        result = (TextView) findViewById(R.id.result);

        if (savedInstanceState == null) {
            packageName.setText("com.hanks.android.fypapplication");
            applicationName.setText("FYPApplication");
            logFilter.setText("password");
        } else {
            final String packageNameKey = savedInstanceState.getString(PACKAGE_NAME);
            packageName.setText(packageNameKey);
            final String appNameKey = savedInstanceState.getString(APP_NAME);
            applicationName.setText(appNameKey);
            final String logFilterKey = savedInstanceState.getString(LOG_FILTER);
            logFilter.setText(logFilterKey);

        }

        exploitButton.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                String exploitResult = SharedPreferencesReader.readFile(packageName.getText().toString(), applicationName.getText().toString());
                result.setText(exploitResult);
            }
        });

        exploitButton2.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                String logResult = LogReader.readLog(logFilter.getText().toString());
                result.setText(logResult);
            }
        });
    }

    @Override
    protected void onSaveInstanceState(Bundle outState) {
        outState.putString(PACKAGE_NAME, packageName.getText().toString());
        outState.putString(APP_NAME, applicationName.getText().toString());
        outState.putString(LOG_FILTER, logFilter.getText().toString());
        super.onSaveInstanceState(outState);
    }
}
